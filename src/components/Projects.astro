---
import { Image } from "astro:assets";

const projects = [
  {
    name: "GigNesia",
    type: "Fullstack Web App",
    stack: ["React", "Express.js", "MongoDB", "Midtrans"],
    image:
      "https://lh3.googleusercontent.com/pw/AP1GczNCskKju8ki2XVwo7Ro9riggCZJOPRmkuMDTTgo0L0mRB9aXw-mP4042N5hT6uKz_hDGK5W3sF5ekjFpLRmV21zDXuu5PyjIrczT5e4MGHuoOVgIH08UCqSVxAQIZZ8DIbqgMtlb7AE1EBudOOljZV2=w1888-h945-s-no-gm?authuser=0",
    github: "https://github.com/emnsxyz24/gignesia",
    deploy: "https://gignesia.vercel.app/",
    description:
      "Freelance marketplace platform connecting clients with freelancers",
  },
  {
    name: "Invoicipedia",
    type: "Fullstack Web App",
    stack: ["Next.js", "TypeScript", "Clerk", "Midtrans"],
    image:
      "https://lh3.googleusercontent.com/pw/AP1GczPI5O2mQ0EJpszbT6-9bbtIlzv6bBL0SSZ3H6G59CRbKtjTZuSMRPDvZz6MILOKmK2cWOh6-9bQbINXOu6MRqE9sMv0H7zasqHPA5DGagDjwKph7lwcfejAkOzwXjbqw-bbsloi5_7eM-ml9DsNNnwC=w1889-h944-s-no-gm?authuser=0",
    github: "https://github.com/emnsxyz24/simple-invoicing-app",
    deploy: "https://simple-invoicing-app.vercel.app/",
    description: "Simple invoicing app with authentication and payments",
  },
  {
    name: "Kedai Imaji",
    type: "Fullstack Web Application",
    stack: ["Flask", "MongoDB", "Python"],
    image:
      "https://lh3.googleusercontent.com/pw/AP1GczNL-YuoJUXNv82hKXAkOqOLDaRS3reN6Z17bbyIulboXJrLh2sjEmpHEeRRibLY8mF1WkXbORm8MnuYkP5_fd9OEeV-EuwthKY6PHU7ov0gdI29IeKMXgw9tdKEUJKGXOnZaESgcWk8iXvZyxyhodNq=w1892-h951-s-no-gm?authuser=0",
    github: "https://github.com/emnsxyz24/MSIB-task-coffeeshop",
    deploy: "https://last-project-fxi5.vercel.app/",
    description: "Coffee shop app with menu, orders, and inventory",
  },
  {
    name: "Portfolio",
    type: "Web Application",
    stack: ["Astro", "Tailwind"],
    image:
      "https://lh3.googleusercontent.com/pw/AP1GczPhJrTiG7kI1IxcpvhXNP8QfCndxoa3U14e1XlWMEqwPbkzqlccmEzsOVpDJC6HGilJ2nPM9WK5iaMxvjlmFICEylqYR59kDAk6U7ItKgNhPEaJqRELQFjLfjUyZaRWshM5VNU5RKpb2vQoysLUqbMJ=w1882-h944-s-no-gm",
    github: "https://github.com/emnsxyz24/new-as-portfolio",
    deploy: "https://edymikhael-portfolio.vercel.app/",
    description: "Personal Portfolio",
  },
];
---

<!-- splide - slide -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4/dist/css/splide.min.css"
/>

<section class="py-24 border-b border-border-dark overflow-hidden" id="work">
  <div
    class="px-6 md:px-10 mb-12 flex flex-col md:flex-row md:justify-between md:items-end gap-4 max-w-[1400px] mx-auto"
  >
    <h2 class="text-4xl md:text-5xl font-bold uppercase tracking-tight">
      Projects // Experiences
    </h2>
    <div class="flex gap-2 items-center">
      <span class="material-symbols-outlined text-primary animate-pulse"
        >arrow_right_alt</span
      >
      <span class="text-sm font-bold uppercase tracking-widest text-primary"
        >Drag or Scroll</span
      >
    </div>
  </div>

  <section class="splide" id="projects-splide" aria-label="Projects Carousel">
    <div class="splide__track">
      <ul class="splide__list">
        {
          projects.map((project, index) => (
            <li class="splide__slide px-4">
              <div class="group relative">
                <div class="aspect-4/3 w-full overflow-hidden bg-surface-dark border border-border-dark mb-6 relative">
                  <Image
                    alt={project.name}
                    class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500 scale-100 group-hover:scale-105"
                    src={project.image}
                    width={800}
                    height={600}
                  />

                  <div class="absolute bottom-4 right-4 flex gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-300">
                    {project.github && (
                      <a
                        href={project.github}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="flex items-center gap-2 px-3 py-2 bg-background-dark/90 border border-border-dark hover:border-primary hover:text-primary transition-colors text-sm font-bold uppercase"
                      >
                        <svg
                          class="w-4 h-4"
                          fill="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z" />
                        </svg>
                        GitHub
                      </a>
                    )}
                    {project.deploy && (
                      <a
                        href={project.deploy}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="flex items-center gap-2 px-3 py-2 bg-primary text-background-dark hover:bg-white transition-colors text-sm font-bold uppercase"
                      >
                        <span class="material-symbols-outlined text-base">
                          open_in_new
                        </span>
                        Live
                      </a>
                    )}
                  </div>
                </div>

                <div class="flex justify-between items-start border-t border-border-dark pt-4">
                  <div>
                    <h3 class="text-3xl font-bold uppercase mb-1 group-hover:text-primary transition-colors">
                      {project.name}
                    </h3>
                    <p class="text-gray-400 text-sm uppercase tracking-wider mb-2">
                      {project.type}
                    </p>
                    <div class="flex gap-2 flex-wrap">
                      {project.stack.map((tech) => (
                        <span class="px-2 py-0.5 border border-border-dark text-xs text-gray-500">
                          {tech}
                        </span>
                      ))}
                    </div>
                  </div>
                  <span class="text-4xl font-black text-outline group-hover:text-white transition-colors">
                    {String(index + 1).padStart(2, "0")}
                  </span>
                </div>
              </div>
            </li>
          ))
        }
      </ul>
    </div>
  </section>
</section>

<script
  is:inline
  src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4/dist/js/splide.min.js"
></script>
<script is:inline>
  document.addEventListener("DOMContentLoaded", function () {
    const splide = new Splide("#projects-splide", {
      type: "slide",
      perPage: 3,
      perMove: 1,
      gap: "2rem",
      padding: { left: "2.5rem", right: "2.5rem" },
      arrows: false,
      pagination: false,
      drag: "free",
      snap: true,
      wheel: false,
      speed: 400,
      breakpoints: {
        1024: {
          perPage: 2,
          padding: { left: "1.5rem", right: "1.5rem" },
        },
        768: {
          perPage: 1,
          padding: { left: "1.5rem", right: "1.5rem" },
        },
      },
    });

    splide.mount();

    const splideEl = document.getElementById("projects-splide");
    const track = splideEl.querySelector(".splide__track");

    let isAnimating = false;
    const BOUNDARY_DELAY = 10;

    splide.on("move", function () {
      isAnimating = true;
    });

    splide.on("moved", function () {
      setTimeout(() => {
        isAnimating = false;
      }, BOUNDARY_DELAY);
    });

    track.addEventListener(
      "wheel",
      function (e) {
        const isScrollingUp = e.deltaY < 0;
        const isScrollingDown = e.deltaY > 0;
        const isAtStart = splide.index === 0;
        const isAtEnd = splide.index >= splide.length - splide.options.perPage;

        if (isAnimating) {
          e.preventDefault();
          return;
        }

        if (isScrollingUp && isAtStart) {
          return;
        }

        if (isScrollingDown && isAtEnd) {
          return;
        }

        e.preventDefault();

        if (isScrollingDown) {
          splide.go(">");
        } else {
          splide.go("<");
        }
      },
      { passive: false },
    );
  });
</script>

<style>
  .splide__slide {
    opacity: 0.7;
    transition: opacity 0.3s ease;
  }
  .splide__slide.is-active,
  .splide__slide:hover {
    opacity: 1;
  }
</style>
